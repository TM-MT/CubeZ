# CubeZ

## 問題設定

矩形領域の定常熱伝導方程式を解く。
Z軸上下面に同心円状の温度分布を与える
XY軸方向はディリクレ（ゼロ）条件

JACOBI
Point SOR
SOR2SMA
PBiCGSTAB (前処理は他の反復法を指定)
LSOR
LJACOBI

## コードメモ

###

-  Time to solutionの点からはPBiCGSTABが最も反復回数が少なく、良い候補。ただし、内積計算はB/Fが大きいので計算速度が上がらない。チューニングにより改善を試みる。

- 前処理はAX系のものを導入し、FLOPSを稼ぐ。ある程度の反復により、BiCGSTAB自体の反復を抑え、高B/F処理の回数を減らす。

- SOR2SMAは収束性がよいが、ストライドメモリアクセスのためにB/Fは高くなる。CMA実装は、高バンド幅の時には性能が出たが、以前の実装では低B/Fアーキでは意外とB/Fが高くなってしまう。SIMDのshuffleを使う実装をテスト。

- LSORはPoint SOR系よりも収束性がよい。ただし、LUは逐次アルゴリズムなので、PCRなどの実装か、ij方向にベクトル化。テスト実装では、ijループを内側にしてベクトル化はできたが、LSORの緩和スイープが適切にできず、Jacobi的な実装となったため、反復回数が増える。kループを内側にして、ベクトル化するため、SIMDでロードした8要素をシャッフルしてベクトル化する。

- LUは行列を分解したあと、再利用することにより実効時間は約半分程度に減らせる。

- SIMD化に必要な４（８）つの要素は、連続する(i,j)の組や2-colorオーダリングに従う方法を評価。

- 実ソルバーでは、場所により係数行列の要素が異なるが、ビットエンコーディングのアイデアを使う。
